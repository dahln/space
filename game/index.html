<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Space Game</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="title">
        <div class="title-main">Galactic Hero 6</div>
        <div class="title-sub">An arcade odyssey</div>
    </div>
    <div id="hud">
        <div id="levelDisplay">Level: 1</div>
        <div id="livesDisplay">Lives: 5</div>
    </div>
    <canvas id="gameCanvas"></canvas>
    <div id="gameOverOverlay" role="dialog" aria-hidden="true" style="display:none;">
        <div class="overlay-content">
            <h1>Game Over</h1>
            <p>Your ship fades into the void â€” all lives are lost. Rise again and forge a new legend.</p>
            <p>Press Enter or click Restart to play again.</p>
            <button id="restartButton" class="overlay-button">Restart</button>
        </div>
    </div>
    <div id="startModal" role="dialog" aria-hidden="false" style="display:flex;">
        <div class="overlay-content">
            <h1>Mission Briefing</h1>
                <p>
                    The Outpost stations were not built to attack. They were watchtowers, carved from old hulls and
                    fitted with defensive turrets to keep a forgotten shipping lane safe. For decades they kept the
                    trail clear â€” shepherding convoys, relaying distress beacons, and tending to the delicate balance
                    of commerce between the inner colonies and the rim worlds.
                </p>
                <p>
                    Then the cargo drives started to fail. Shipments of stabilizer ore and coolant arrived late, or
                    not at all. The corporations that funded the Outposts grew hungry for salvage and secrets. Pilots began
                    to vanish near certain waypoints. Rumors spread that a hidden archive had been uncovered: blueprints
                    for a drive modifier that could let a single convoy outrun blockades and taxes.
                </p>
                <p>
                    The stations fractured into factions. Some upheld their original mandate â€” protect and watch. Others
                    sold their turrets to the highest bidder or rewired their targeting logic to hunt anything that
                    carried the old seals. What was once a neutral line of guardians became a gauntlet of suspicion,
                    and then, eventually, a battlefield.
                </p>
                <p>
                    You fly not because you seek glory, but because you fly where the job takes you. The fight is a
                    tangle of contracts, survivors revenge, and corporate hunger. Each station you take down is
                    another node freed from whatever grip has twisted its purpose. Each skirmish is a step toward
                    a passage where ships can travel without fear â€” or toward the next faction that will claim it.
                </p>
                <p class="muted-note">â€” Transmission from an anonymous convoy pilot</p>
                <p class="muted-note"><strong>Controls &amp; Tips:</strong> Arrow keys to steer, Space to fire, Esc to pause. Use short thrust bursts to dodge; conserve momentum. Offscreen stations are indicated at the screen edge.</p>
            <button id="startButton" class="overlay-button">Launch Mission</button>
        </div>
    </div>
    <div id="muteButton" role="button" aria-label="Mute audio" title="Mute audio">ðŸ”Š</div>
    <script src="game.js"></script>
    <script>
        // Navigate to the story page when the HUD button is clicked.
        document.addEventListener('DOMContentLoaded', function () {
            const btn = document.getElementById('storyButton');
            if (btn) {
                btn.addEventListener('click', function (e) {
                    // use a normal navigation so the story page can be shared/bookmarked
                    window.location.href = 'story.html';
                });
            }
            // Mute button wiring (communicates with game.js global setMuted if present)
            const mBtn = document.getElementById('muteButton');
            if (mBtn) {
                // prevent this control from being focusable to avoid stealing keyboard input
                mBtn.setAttribute('tabindex', '-1');
                // initialize text based on persisted state if game exposes it
                try {
                    const saved = localStorage.getItem('space_game_muted');
                    const isMuted = saved === '1';
                    mBtn.classList.toggle('muted', isMuted);
                    mBtn.textContent = isMuted ? 'ðŸ”‡' : 'ðŸ”Š';
                } catch (e) { }
                mBtn.addEventListener('pointerdown', function (ev) {
                    // prevent the element from receiving focus
                    ev.preventDefault();
                    // if game exposes setMuted, call it, otherwise toggle localStorage and update UI
                    try {
                        if (typeof setMuted === 'function') {
                            setMuted(!window.muted);
                        } else {
                            const saved = localStorage.getItem('space_game_muted');
                            const isMuted = saved === '1';
                            localStorage.setItem('space_game_muted', isMuted ? '0' : '1');
                            mBtn.classList.toggle('muted', !isMuted);
                            mBtn.textContent = !isMuted ? 'ðŸ”‡' : 'ðŸ”Š';
                        }
                    } catch (e) {
                        // best-effort UI toggle
                        const cls = mBtn.classList.toggle('muted');
                        mBtn.textContent = cls ? 'ðŸ”‡' : 'ðŸ”Š';
                        try { localStorage.setItem('space_game_muted', cls ? '1' : '0'); } catch (e) { }
                    }
                });
            }
        });
    </script>
</body>
</html>
